:root { 
    --bg: #f5f5f5; 
    --text: #222; 
    --card-bg: #ffffff; 
    --surface: #fafafa; 
    --border: #ddd; 
    --muted: #666; 
    --primary: #007bff; 
    --primary-hover: #0056b3; 
    --on-primary: #ffffff; 
    --accent: #ffcc00; 
    --bubble-bg: #e9ecef; 
    --input-bg: #ffffff; 
    --matrix-color: #00aa55;
}
.dark { 
    --bg: #0f141a; 
    --text: #e6edf3; 
    --card-bg: #161b22; 
    --surface: #0d1117; 
    --border: #30363d; 
    --muted: #9da7b0; 
    --primary: #1f6feb; 
    --primary-hover: #255fbd; 
    --on-primary: #ffffff; 
    --accent: #f2c744; 
    --bubble-bg: #21262d; 
    --input-bg: #0d1117; 
    --matrix-color: #23d18b;
}
body { font-family: Arial, sans-serif; margin: 20px; background: var(--bg); color: var(--text); }
#matrix-canvas { position: fixed; inset: 0; width: 100%; height: 100%; z-index: 0; pointer-events: none; }
.container { position: relative; z-index: 1; max-width: 800px; margin: 0 auto; background: var(--card-bg); padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); border: 1px solid var(--border); }
.container.glow-green { box-shadow: 0 0 0 2px rgba(52,199,89,0.6), 0 0 22px rgba(53,198,90,0.6), inset 0 0 0 1px rgba(52,199,89,0.5); border-color: rgba(52,199,89,0.8); transition: box-shadow 240ms ease, border-color 240ms ease; }
/* Side draggable nodes & SVG wires */
.wires { position: fixed; inset: 0; pointer-events: none; z-index: 1; }
.func-node { position: fixed; z-index: 2; pointer-events: auto; background: var(--bubble-bg); color: var(--text); border: 1px solid var(--border); border-radius: 16px; padding: 14px 18px; font-size: 16px; cursor: grab; box-shadow: 0 3px 12px rgba(0,0,0,0.18); user-select: none; }
.func-node:active { cursor: grabbing; }
.func-node:hover { filter: brightness(1.05); }
.func-node.active { box-shadow: 0 0 0 2px rgba(52,199,89,0.6), 0 0 18px rgba(52,199,89,0.55), inset 0 0 0 1px rgba(52,199,89,0.6); border-color: rgba(52,199,89,0.8); }
.func-node.fadeout { transition: box-shadow 280ms ease, border-color 280ms ease, filter 280ms ease; box-shadow: none !important; filter: brightness(1); border-color: var(--border); }
.wire { fill: none; stroke: #b0b0b0; stroke-width: 5px; stroke-linecap: round; filter: drop-shadow(0 0 2px rgba(0,0,0,0.4)); stroke-linejoin: round; }
.wire.glow { stroke: #35c65a; filter: drop-shadow(0 0 6px rgba(53,198,90,0.9)); }
.joint { display: none; }
.beam-path { fill: none; stroke: rgba(53,198,90,0.95); stroke-width: 6px; stroke-linecap: round; filter: drop-shadow(0 0 10px rgba(53,198,90,0.9)); opacity: 0; transition: opacity 140ms ease; }
.beam-path.dim { stroke: rgba(53,198,90,0.35); filter: drop-shadow(0 0 6px rgba(53,198,90,0.5)); }
.face-container { width: 220px; height: 260px; margin: 0 auto 20px; background: var(--card-bg); border: 2px solid var(--border); border-radius: 50%; box-shadow: inset 0 10px 30px rgba(0,0,0,0.07), 0 4px 12px rgba(0,0,0,0.06); display: grid; place-items: center; overflow: hidden; padding: 8px; }
.face-emoji { font-size: 96px; line-height: 1; transition: transform 200ms ease, opacity 200ms ease; white-space: nowrap; display: block; }
.face-emoji.anim { transform: scale(0.85); opacity: 0.2; }
.chat-box { height: 240px; border: 1px solid var(--border); padding: 12px; overflow-y: auto; margin-bottom: 10px; background: var(--surface); border-radius: 5px; }
.message { margin: 10px 0; padding: 10px; border-radius: 5px; max-width: 75%; }
.user { background: var(--primary); color: var(--on-primary); text-align: right; margin-left: auto; }
.bot { background: var(--bubble-bg); color: var(--text); margin-right: auto; }
.message pre { margin: 0; font-size: 14px; }
.input-area { display: flex; gap: 10px; }
.input-area input { flex: 1; padding: 10px; border: 1px solid var(--border); border-radius: 5px; background: var(--input-bg); color: var(--text); }
.input-area button { padding: 10px 20px; background: var(--primary); color: var(--on-primary); border: none; border-radius: 5px; cursor: pointer; }
.input-area button:hover { background: var(--primary-hover); }
.stats { display: flex; gap: 20px; margin-top: 20px; }
.stat-box { background: var(--bubble-bg); padding: 10px; border-radius: 5px; flex: 1; text-align: center; }
h1 { color: var(--text); text-align: center; }
.loading { color: var(--muted); font-style: italic; }
pre { white-space: pre-wrap; word-break: break-word; }
/* Lightbox */
.lightbox { position: fixed; inset: 0; background: rgba(0,0,0,0.82); display: none; align-items: center; justify-content: center; z-index: 1000; }
.lightbox.open { display: flex; }
.lightbox-content { position: relative; max-width: 92vw; max-height: 92vh; }
.lightbox-content img { max-width: 100%; max-height: 92vh; border-radius: 8px; box-shadow: 0 8px 24px rgba(0,0,0,0.4); }
.lightbox-close { position: absolute; top: 8px; right: 8px; background: rgba(0,0,0,0.6); color: #fff; border: none; border-radius: 50%; width: 36px; height: 36px; cursor: pointer; font-size: 18px; }
.lightbox-download { position: absolute; right: 8px; bottom: 8px; background: rgba(0,0,0,0.6); color: #fff; border: none; border-radius: 18px; padding: 8px 12px; cursor: pointer; font-size: 14px; text-decoration: none; }
.controls { display: flex; justify-content: center; margin-bottom: 12px; }
.next-btn { background: var(--accent); color: #222; border: none; border-radius: 20px; padding: 8px 16px; cursor: pointer; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
.next-btn:disabled { opacity: 0.5; cursor: not-allowed; }
.disabled { opacity: 0.7; pointer-events: none; }
.theme-btn { margin-left: 8px; background: var(--bubble-bg); color: var(--text); border: 1px solid var(--border); border-radius: 20px; padding: 8px 12px; cursor: pointer; }
/* Responsive */
@media (max-width: 768px) {
    body { margin: 12px; }
    .container { max-width: 100%; padding: 14px; }
    .face-container { width: 180px; height: 200px; padding: 6px; }
    .face-emoji { font-size: 72px; }
    .chat-box { height: 42vh; padding: 10px; }
    .message { max-width: 90%; }
    .input-area { flex-direction: column; gap: 8px; }
    .input-area button { width: 100%; }
    .stats { gap: 10px; }
    .func-node { padding: 10px 14px; font-size: 14px; }
}
@media (max-width: 420px) {
    h1 { font-size: 18px; }
    .face-container { width: 150px; height: 170px; padding: 6px; }
    .face-emoji { font-size: 56px; }
    .chat-box { height: 44vh; }
    .next-btn { padding: 6px 12px; }
}

